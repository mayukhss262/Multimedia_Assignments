================================================================================
    HUFFMAN CODING WITH COMMON CODEBOOK FOR ALL GRAY CODED BIT-PLANES
    Alternating Run-Length Encoding (symbols are run lengths: 0,1,2,3,...)
================================================================================

ENCODING SCHEME:
  - Rows assumed to start with 1
  - If row starts with 0, first symbol is 0 (zero-length run of 1s)
  - Symbols alternate: run of 1s, run of 0s, run of 1s, ...
  - Example: 11000111 -> [2, 3, 3] (2 ones, 3 zeros, 3 ones)
  - Example: 0001101  -> [0, 3, 2, 1, 1]

--------------------------------------------------------------------------------
COMMON HUFFMAN CODEBOOK (shared across all bit planes)
--------------------------------------------------------------------------------
Total symbols across all planes: 154212
Unique symbols (run lengths): 149
Combined entropy: 2.7077 bits/symbol

  Run Length   Count        Probability  Huffman Code                  
  ------------ ------------ ------------ ------------------------------
  0            983          0.006374     11101110                      
  1            68320        0.443026     0                             
  2            33785        0.219082     10                            
  3            17734        0.114998     1111                          
  4            10021        0.064982     1100                          
  5            5836         0.037844     11011                         
  6            3571         0.023156     111010                        
  7            2362         0.015317     110101                        
  8            1737         0.011264     1110011                       
  9            1233         0.007995     1101001                       
  10           957          0.006206     11101100                      
  11           778          0.005045     11100011                      
  12           578          0.003748     11010001                      
  13           544          0.003528     11010000                      
  14           527          0.003417     111011110                     
  15           449          0.002912     111001011                     
  16           440          0.002853     111001010                     
  17           325          0.002107     111000010                     
  18           251          0.001628     1110110111                    
  19           231          0.001498     1110110100                    
  20           199          0.001290     1110010000                    
  21           171          0.001109     1110000111                    
  22           189          0.001226     1110001010                    
  23           172          0.001115     1110001000                    
  24           136          0.000882     11101111111                   
  25           121          0.000785     11101101011                   
  26           136          0.000882     11101111110                   
  27           132          0.000856     11101111100                   
  28           114          0.000739     11101101010                   
  29           155          0.001005     1110000010                    
  30           170          0.001102     1110000110                    
  31           126          0.000817     11101101101                   
  32           105          0.000681     11100100100                   
  33           113          0.000733     11100100111                   
  34           98           0.000635     11100010111                   
  35           101          0.000655     11100100010                   
  36           73           0.000473     11100000001                   
  37           69           0.000447     11100000000                   
  38           91           0.000590     11100010010                   
  39           55           0.000357     111001001100                  
  40           80           0.000519     11100000110                   
  41           54           0.000350     111001000111                  
  42           54           0.000350     111001001011                  
  43           48           0.000311     111000101100                  
  44           37           0.000240     111000000101                  
  45           38           0.000246     111000000110                  
  46           45           0.000292     111000100110                  
  47           29           0.000188     1110010011011                 
  48           24           0.000156     1110010001100                 
  49           24           0.000156     1110001001111                 
  50           31           0.000201     1110110110001                 
  51           28           0.000182     1110010011010                 
  52           17           0.000110     11101111101101                
  53           17           0.000110     11101111101111                
  54           19           0.000123     1110000001110                 
  55           27           0.000175     1110010010100                 
  56           19           0.000123     1110000001001                 
  57           18           0.000117     1110000001000                 
  58           13           0.000084     11100100101010                
  59           21           0.000136     1110000011111                 
  60           31           0.000201     1110110110010                 
  61           17           0.000110     11101111101100                
  62           21           0.000136     1110000011101                 
  63           11           0.000071     11100010011100                
  64           12           0.000078     11100100011011                
  65           17           0.000110     11101111101110                
  66           12           0.000078     11100010110100                
  67           16           0.000104     11101101100110                
  68           6            0.000039     111000101101111               
  69           7            0.000045     111011011000001               
  70           11           0.000071     11100000111101                
  71           8            0.000052     111011111010010               
  72           5            0.000032     111000000111110               
  73           7            0.000045     111001001010111               
  74           8            0.000052     111011111010011               
  75           6            0.000039     111001000110100               
  76           3            0.000019     1110010001101010              
  77           2            0.000013     11100100101011010             
  78           7            0.000045     111011011000000               
  79           5            0.000032     111000000111111               
  80           6            0.000039     111000101101101               
  81           5            0.000032     111000001110011               
  82           6            0.000039     111000101101110               
  83           2            0.000013     11101111101011011             
  84           5            0.000032     111000001111000               
  85           5            0.000032     111000001111001               
  86           2            0.000013     11101101100001010             
  87           1            0.000006     111011111010001101            
  88           4            0.000026     1110111110100000              
  89           3            0.000019     1110010001101011              
  90           2            0.000013     11101101100111010             
  91           3            0.000019     1110001011010101              
  92           2            0.000013     11101111101011101             
  94           1            0.000006     11100000111001000             
  95           2            0.000013     11101101100111011             
  97           2            0.000013     11101111101010100             
  98           2            0.000013     11101101100001011             
  99           1            0.000006     111011111010101100            
  101          1            0.000006     11100000111001001             
  102          1            0.000006     111011011000011110            
  103          3            0.000019     1110001011011000              
  104          4            0.000026     1110110110011100              
  105          10           0.000065     11100000111000                
  106          6            0.000039     111000100111010               
  107          2            0.000013     11101111101011111             
  108          3            0.000019     1110001001110111              
  109          2            0.000013     11101111101011010             
  110          2            0.000013     11101101100001110             
  111          1            0.000006     11100000011110000             
  112          3            0.000019     1110001011010110              
  113          1            0.000006     111011011000011111            
  114          1            0.000006     111011111010101101            
  115          1            0.000006     111011111010111000            
  116          2            0.000013     11101111101010111             
  117          2            0.000013     11101111101010010             
  118          1            0.000006     111011011000011000            
  119          5            0.000032     111000000111101               
  120          2            0.000013     11101111101010011             
  121          3            0.000019     1110010010101100              
  122          3            0.000019     1110000011100101              
  123          1            0.000006     111011011000010011            
  124          2            0.000013     11101111101011110             
  125          4            0.000026     1110110110011110              
  126          3            0.000019     1110001001110110              
  127          1            0.000006     111011111010001100            
  128          1            0.000006     111011011000010010            
  133          3            0.000019     1110001011010111              
  134          1            0.000006     11100000011110011             
  135          4            0.000026     1110110110011111              
  136          4            0.000026     1110111110101100              
  137          1            0.000006     11100000011110010             
  139          1            0.000006     11100000011110001             
  140          2            0.000013     11100100101011011             
  142          2            0.000013     11101111101010001             
  166          1            0.000006     111011111010111001            
  175          2            0.000013     11101111101010101             
  202          3            0.000019     1110001011010100              
  203          1            0.000006     111011011000011011            
  204          2            0.000013     11101111101000011             
  205          2            0.000013     11101111101000010             
  206          1            0.000006     111011011000011010            
  207          2            0.000013     11101111101000101             
  208          2            0.000013     11101111101000100             
  209          2            0.000013     11101111101000111             
  210          2            0.000013     11101111101010000             
  211          1            0.000006     111011011000010001            
  212          3            0.000019     1110001011011001              
  213          1            0.000006     111011011000010000            
  214          1            0.000006     111011011000011001            

================================================================================
COMPRESSION RESULTS PER BIT PLANE (using common codebook)
================================================================================

gray_bit_plane_0.png:
  Symbols: 32970, Huffman bits: 69613
  Compression ratio: 1.0622
  Average code length: 2.1114 bits/symbol

gray_bit_plane_1.png:
  Symbols: 32675, Huffman bits: 69756
  Compression ratio: 1.0644
  Average code length: 2.1348 bits/symbol

gray_bit_plane_2.png:
  Symbols: 29018, Huffman bits: 67873
  Compression ratio: 1.0357
  Average code length: 2.3390 bits/symbol

gray_bit_plane_3.png:
  Symbols: 21975, Huffman bits: 60598
  Compression ratio: 0.9247
  Average code length: 2.7576 bits/symbol

gray_bit_plane_4.png:
  Symbols: 16391, Huffman bits: 52189
  Compression ratio: 0.7963
  Average code length: 3.1840 bits/symbol

gray_bit_plane_5.png:
  Symbols: 8690, Huffman bits: 39602
  Compression ratio: 0.6043
  Average code length: 4.5572 bits/symbol

gray_bit_plane_6.png:
  Symbols: 6499, Huffman bits: 31101
  Compression ratio: 0.4746
  Average code length: 4.7855 bits/symbol

gray_bit_plane_7.png:
  Symbols: 5994, Huffman bits: 33427
  Compression ratio: 0.5101
  Average code length: 5.5767 bits/symbol

================================================================================
SUMMARY
================================================================================

Bit Plane                 Symbols      Huffman Ratio   Avg Code Len
--------------------------------------------------------------------------------
gray_bit_plane_0          32970        1.0622          2.1114      
gray_bit_plane_1          32675        1.0644          2.1348      
gray_bit_plane_2          29018        1.0357          2.3390      
gray_bit_plane_3          21975        0.9247          2.7576      
gray_bit_plane_4          16391        0.7963          3.1840      
gray_bit_plane_5          8690         0.6043          4.5572      
gray_bit_plane_6          6499         0.4746          4.7855      
gray_bit_plane_7          5994         0.5101          5.5767      
--------------------------------------------------------------------------------
Average                                0.8090          3.4308      

Note: Compression ratio = compressed bits / original bits
      Ratio < 1 means compression, Ratio > 1 means expansion
