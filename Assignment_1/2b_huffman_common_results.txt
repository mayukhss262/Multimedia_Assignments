================================================================================
    HUFFMAN CODING WITH COMMON CODEBOOK FOR ALL GRAY CODED BIT-PLANES
    Alternating Run-Length Encoding (symbols are run lengths: 0,1,2,3,...)
================================================================================

ENCODING SCHEME:
  - Rows assumed to start with 1
  - If row starts with 0, first symbol is 0 (zero-length run of 1s)
  - Symbols alternate: run of 1s, run of 0s, run of 1s, ...
  - Example: 11000111 -> [2, 3, 3] (2 ones, 3 zeros, 3 ones)
  - Example: 0001101  -> [0, 3, 2, 1, 1]

--------------------------------------------------------------------------------
COMMON HUFFMAN CODEBOOK (shared across all bit planes)
--------------------------------------------------------------------------------
Total symbols across all planes: 108865
Unique symbols (run lengths): 131
Combined entropy: 2.8995 bits/symbol

  Run Length   Count        Probability  Huffman Code                  
  ------------ ------------ ------------ ------------------------------
  0            872          0.008010     1001110                       
  1            43651        0.400964     0                             
  2            24320        0.223396     111                           
  3            13219        0.121426     101                           
  4            7412         0.068084     1100                          
  5            4329         0.039765     11011                         
  6            2887         0.026519     10001                         
  7            1898         0.017434     110100                        
  8            1542         0.014164     100101                        
  9            1155         0.010609     1101011                       
  10           815          0.007486     1001100                       
  11           680          0.006246     1000011                       
  12           627          0.005759     1000010                       
  13           567          0.005208     11010101                      
  14           481          0.004418     10011111                      
  15           370          0.003399     10010010                      
  16           294          0.002701     10000001                      
  17           279          0.002563     10000000                      
  18           248          0.002278     110101000                     
  19           219          0.002012     100111100                     
  20           206          0.001892     100110110                     
  21           195          0.001791     100110100                     
  22           189          0.001736     100100110                     
  23           157          0.001442     100000111                     
  24           148          0.001359     100000101                     
  25           174          0.001598     100100010                     
  26           135          0.001240     1101010011                    
  27           147          0.001350     100000100                     
  28           105          0.000964     1001101011                    
  29           120          0.001102     1001111010                    
  30           98           0.000900     1001101010                    
  31           84           0.000772     1001000010                    
  32           88           0.000808     1001000110                    
  33           79           0.000726     1001000000                    
  34           89           0.000818     1001000111                    
  35           66           0.000606     11010100100                   
  36           56           0.000514     10011011110                   
  37           48           0.000441     10010011110                   
  38           57           0.000524     10011011111                   
  39           48           0.000441     10010011111                   
  40           40           0.000367     10000011011                   
  41           32           0.000294     100111101101                  
  42           31           0.000285     100111101100                  
  43           32           0.000294     110101001010                  
  44           35           0.000321     110101001011                  
  45           20           0.000184     100100000110                  
  46           21           0.000193     100100000111                  
  47           24           0.000220     100100111001                  
  48           22           0.000202     100100111000                  
  49           22           0.000202     100100001111                  
  50           18           0.000165     100000110000                  
  51           13           0.000119     1001101110011                 
  52           22           0.000202     100100001101                  
  53           26           0.000239     100110111010                  
  54           19           0.000175     100000110100                  
  55           18           0.000165     100000110001                  
  56           12           0.000110     1001101110000                 
  57           12           0.000110     1001101110010                 
  58           22           0.000202     100100001110                  
  59           8            0.000073     10011110111111                
  60           10           0.000092     1001000011000                 
  61           8            0.000073     10011110111110                
  62           12           0.000110     1001101110001                 
  63           2            0.000018     1001101110111100              
  64           19           0.000175     100000110101                  
  65           5            0.000046     10010000010001                
  66           9            0.000083     1000001100110                 
  67           5            0.000046     10010000010101                
  68           6            0.000055     10010011101110                
  69           5            0.000046     10010000010100                
  70           4            0.000037     100111101110011               
  71           6            0.000055     10010011101111                
  72           10           0.000092     1001000001001                 
  73           6            0.000055     10010011101001                
  74           6            0.000055     10010011101010                
  75           3            0.000028     100100111010001               
  76           4            0.000037     100111101110001               
  77           4            0.000037     100111101110000               
  78           3            0.000028     100100001100111               
  80           4            0.000037     10000011001010                
  81           1            0.000009     10011011101111011             
  82           3            0.000028     100100111011000               
  85           3            0.000028     100100111010000               
  86           1            0.000009     1001000001011100              
  87           7            0.000064     10011011101100                
  88           7            0.000064     10011011101101                
  89           1            0.000009     10011110111001011             
  90           1            0.000009     10011110111101010             
  91           2            0.000018     1001111011110111              
  92           9            0.000083     1000001100100                 
  93           1            0.000009     10011011101111101             
  94           9            0.000083     1000001100111                 
  95           3            0.000028     100100111010110               
  97           2            0.000018     1001111011101110              
  99           3            0.000028     100100111011011               
  100          1            0.000009     10011110111001001             
  101          1            0.000009     10011011101110001             
  102          3            0.000028     100100111011001               
  103          5            0.000046     10000011001011                
  104          1            0.000009     10011110111001010             
  105          1            0.000009     10011110111011010             
  106          5            0.000046     10010000010110                
  107          2            0.000018     1001111011101001              
  108          2            0.000018     1001101110111001              
  110          5            0.000046     10010000010000                
  111          4            0.000037     100111101110101               
  112          3            0.000028     100100001100110               
  114          2            0.000018     1001111011101000              
  115          1            0.000009     10011110111101011             
  117          4            0.000037     100111101111001               
  119          3            0.000028     100100111011010               
  120          5            0.000046     10010000110010                
  126          1            0.000009     1001000001011110              
  127          1            0.000009     10011110111001000             
  146          1            0.000009     10011011101111010             
  152          2            0.000018     1001000001011111              
  153          1            0.000009     10011110111011011             
  154          1            0.000009     10011011101110000             
  155          1            0.000009     1001000001011101              
  178          3            0.000028     100100111010111               
  179          2            0.000018     1001111011101100              
  180          1            0.000009     10011011101111111             
  181          2            0.000018     1001101110111011              
  182          2            0.000018     1001101110111010              
  183          2            0.000018     1001111011110001              
  184          2            0.000018     1001111011110000              
  185          2            0.000018     1001111011110110              
  186          1            0.000009     10011011101111110             
  187          2            0.000018     1001111011110100              
  188          2            0.000018     1001111011101111              
  189          1            0.000009     10011011101111100             

================================================================================
COMPRESSION RESULTS PER BIT PLANE (using common codebook)
================================================================================

gray_bit_plane_0.png:
  Symbols: 24041, Huffman bits: 55578
  Compression ratio: 1.0978
  Average code length: 2.3118 bits/symbol

gray_bit_plane_1.png:
  Symbols: 22097, Huffman bits: 54126
  Compression ratio: 1.0692
  Average code length: 2.4495 bits/symbol

gray_bit_plane_2.png:
  Symbols: 19456, Huffman bits: 51123
  Compression ratio: 1.0098
  Average code length: 2.6276 bits/symbol

gray_bit_plane_3.png:
  Symbols: 15523, Huffman bits: 45342
  Compression ratio: 0.8956
  Average code length: 2.9210 bits/symbol

gray_bit_plane_4.png:
  Symbols: 12274, Huffman bits: 39482
  Compression ratio: 0.7799
  Average code length: 3.2167 bits/symbol

gray_bit_plane_5.png:
  Symbols: 6616, Huffman bits: 29652
  Compression ratio: 0.5857
  Average code length: 4.4819 bits/symbol

gray_bit_plane_6.png:
  Symbols: 4858, Huffman bits: 23473
  Compression ratio: 0.4637
  Average code length: 4.8318 bits/symbol

gray_bit_plane_7.png:
  Symbols: 4000, Huffman bits: 24119
  Compression ratio: 0.4764
  Average code length: 6.0297 bits/symbol

================================================================================
SUMMARY
================================================================================

Bit Plane                 Symbols      Huffman Ratio   Avg Code Len
--------------------------------------------------------------------------------
gray_bit_plane_0          24041        1.0978          2.3118      
gray_bit_plane_1          22097        1.0692          2.4495      
gray_bit_plane_2          19456        1.0098          2.6276      
gray_bit_plane_3          15523        0.8956          2.9210      
gray_bit_plane_4          12274        0.7799          3.2167      
gray_bit_plane_5          6616         0.5857          4.4819      
gray_bit_plane_6          4858         0.4637          4.8318      
gray_bit_plane_7          4000         0.4764          6.0297      
--------------------------------------------------------------------------------
Average                                0.7973          3.6088      

Note: Compression ratio = compressed bits / original bits
      Ratio < 1 means compression, Ratio > 1 means expansion
